<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³Û•Ø±Û•Ú©ÛŒ - Home Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        * { -webkit-user-select: none; user-select: none; box-sizing: border-box; }
        
        :root { --bg-color: #fffbf2; --border-color: #d4af37; --highlight-color: #27ae60; --text-color: #2c3e50; --nav-bg: #ffffff; }
        
        body { font-family: 'Amiri', serif; background-color: #f8f9fa; margin: 0; padding: 0; display: flex; justify-content: center; height: 100vh; overflow: hidden; }
        
        .app-container { width: 100%; max-width: 600px; background-color: var(--bg-color); height: 100%; position: relative; display: flex; flex-direction: column; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        
        /* Header */
        .header { background: white; padding: 15px; border-bottom: 2px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; color: var(--border-color); box-shadow: 0 2px 5px rgba(0,0,0,0.05); z-index: 50; }
        .icon-group { display: flex; gap: 15px; z-index: 10; }
        .header-btn { cursor: pointer; font-size: 22px; padding: 5px; transition: 0.3s; position: relative; }
        .header-btn:hover { transform: scale(1.1); color: #b6962f; }
        
        /* Notification Dot */
        .notif-badge { position: absolute; top: 0; right: 0; width: 10px; height: 10px; background: red; border-radius: 50%; border: 1px solid white; display: none; }

        /* Main Content Area */
        .content { flex-grow: 1; overflow-y: auto; padding: 20px; padding-bottom: 80px; scroll-behavior: smooth; }

        /* Welcome Card */
        .hero-card { background: linear-gradient(135deg, var(--border-color), #f1c40f); color: white; padding: 25px; border-radius: 15px; text-align: center; margin-bottom: 25px; box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4); position: relative; overflow: hidden; }
        .hero-title { font-size: 24px; margin-bottom: 10px; position: relative; z-index: 2; }
        .hero-date { font-size: 16px; opacity: 0.9; position: relative; z-index: 2; }
        .hero-pattern { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.1; background-image: url('https://www.transparenttextures.com/patterns/arabesque.png'); }

        /* Grid Menu */
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; }
        .card { background: white; padding: 20px; border-radius: 12px; text-align: center; border: 1px solid #eee; transition: 0.2s; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); text-decoration: none; color: var(--text-color); }
        .card:active { transform: scale(0.95); background-color: #fffbf2; }
        .card-icon { font-size: 32px; }
        .card-title { font-weight: bold; font-size: 18px; }

        /* LIVE FEED SECTION */
        .feed-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .feed-title { font-size: 18px; font-weight: bold; color: var(--border-color); display: flex; align-items: center; gap: 8px; }
        .live-indicator { width: 8px; height: 8px; background: red; border-radius: 50%; animation: blink 1.5s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }

        .feed-card { background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; box-shadow: 0 3px 10px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; transition: 0.5s; position: relative; overflow: hidden; animation: slideIn 0.5s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .feed-card:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        .feed-tag { position: absolute; top: 10px; left: 10px; font-size: 10px; padding: 3px 8px; border-radius: 10px; color: white; font-weight: bold; }
        .tag-ayah { background: var(--highlight-color); } /* Green */
        .tag-hadith { background: #3498db; } /* Blue */
        .tag-dua { background: #e67e22; } /* Orange */
        .tag-info { background: #9b59b6; } /* Purple */
        .tag-name { background: #e74c3c; } /* Red */

        .feed-content { font-size: 17px; line-height: 1.8; color: #444; margin-top: 15px; text-align: justify; }
        .feed-source { font-size: 12px; color: #888; margin-top: 10px; display: block; font-style: italic; border-top: 1px dashed #eee; padding-top: 5px; }

        /* Enable Notif Button */
        .notif-permission { background: #ffeaa7; padding: 10px; font-size: 12px; color: #d35400; border-bottom: 1px solid #fdcb6e; display: none; cursor: pointer; text-align: center; }

        /* Loader */
        .loader { border: 3px solid #f3f3f3; border-top: 3px solid var(--border-color); border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Modals */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 200; align-items: center; justify-content: center; }
        .modal-content { background: white; width: 90%; max-width: 400px; padding: 20px; border-radius: 15px; text-align: center; border: 2px solid var(--border-color); animation: popUp 0.3s ease; position: relative; max-height: 80vh; overflow-y: auto; }
        
        /* Stats & History */
        .stat-row { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; font-size: 14px; }
        .user-list { max-height: 120px; overflow-y: auto; margin-top: 10px; text-align: right; border: 1px solid #f0f0f0; padding: 5px; border-radius: 5px; }
        .user-item { padding: 8px; background: #f9f9f9; margin-bottom: 5px; border-radius: 5px; display: flex; align-items: center; font-size: 12px; }
        .dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-left: 8px; }
        .dot.online { background: #27ae60; box-shadow: 0 0 5px #27ae60; }
        
        .history-list { max-height: 300px; overflow-y: auto; text-align: right; margin-top: 10px; }
        .history-item { background: #f9f9f9; padding: 10px; margin-bottom: 8px; border-radius: 8px; border-right: 3px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
        .h-info { display: flex; flex-direction: column; }
        .h-name { font-weight: bold; font-size: 16px; color: var(--text-color); }
        .h-time { font-size: 11px; color: #888; }
        .clear-btn { background: #e74c3c; color: white; border: none; padding: 5px 15px; border-radius: 15px; font-size: 12px; cursor: pointer; margin-top: 10px; }

        /* Social Media */
        .settings-section-title { margin-top: 20px; font-weight: bold; color: var(--border-color); border-bottom: 1px solid #eee; padding-bottom: 5px; margin-bottom: 15px; }
        .social-row { display: flex; justify-content: center; gap: 15px; margin-bottom: 10px; }
        .social-btn { width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: #f9f9f9; border: 1px solid #ddd; transition: 0.2s; }
        .social-btn img { width: 22px; height: 22px; }
        .social-btn:hover { transform: translateY(-3px); border-color: var(--border-color); background: #fffbf2; }

        /* Bottom Navigation Bar */
        .bottom-nav { position: absolute; bottom: 0; left: 0; width: 100%; background: var(--nav-bg); height: 70px; border-top: 1px solid #eee; display: flex; justify-content: space-around; align-items: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); z-index: 100; }
        .nav-item { text-decoration: none; display: flex; flex-direction: column; align-items: center; color: #999; font-size: 12px; gap: 5px; transition: 0.2s; width: 33.33%; }
        .nav-item.active { color: var(--border-color); font-weight: bold; }
        .nav-icon { font-size: 24px; }
        .nav-item:active { transform: scale(0.9); }

        @keyframes popUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

    </style>
</head>
<body oncontextmenu="return false;">

    <div class="app-container">
        
        <audio id="notif-sound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

        <div class="notif-permission" id="notif-perm-btn" onclick="enableNotifications()">
            ğŸ”” ØªÚ©Ø§ÛŒÛ• Ø¦ÛØ±Û• Ø¯Ø§Ø¨Ú¯Ø±Û• Ø¨Û† Ú†Ø§Ù„Ø§Ú©Ú©Ø±Ø¯Ù†ÛŒ Ø¦Ø§Ú¯Ø§Ø¯Ø§Ø±Ú©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ù¾Û†Ø³ØªÛŒ Ù†ÙˆÛ
        </div>

        <div class="header">
            <div class="icon-group">
                <div class="header-btn" onclick="openSettings()" title="Ú•ÛÚ©Ø®Ø³ØªÙ†">âš™ï¸</div>
                <div class="header-btn" onclick="openHistory()" title="Ù…ÛÚ˜ÙˆÙˆ">
                    ğŸ•’
                    <span class="notif-badge" id="history-badge"></span>
                </div>
            </div>
            <div style="font-weight:bold; font-size:18px;">Ultimate Pro</div>
            <div class="header-btn" onclick="triggerManualUpdate()" title="Ù†ÙˆÛÚ©Ø±Ø¯Ù†Û•ÙˆÛ•">ğŸ”ƒ</div>
        </div>

        <div class="content">
            <div class="hero-card">
                <div class="hero-pattern"></div>
                <div class="hero-title">Ø¨Û•Ø®ÛØ±Ø¨ÛÛŒØª</div>
                <div class="hero-date" id="current-date">...</div>
            </div>

            <div class="menu-grid">
                <a href="quran.html" class="card">
                    <div class="card-icon">ğŸ“–</div>
                    <div class="card-title">Ù‚ÙˆØ±Ø¦Ø§Ù†ÛŒ Ù¾ÛŒØ±Û†Ø²</div>
                </a>
                
                <a href="daily.html" class="card">
                    <div class="card-icon">ğŸ•Œ</div>
                    <div class="card-title">Ú©Ø§ØªÛ•Ú©Ø§Ù†ÛŒ Ø¨Ø§Ù†Ú¯</div>
                </a>

                <a href="daily.html" class="card">
                    <div class="card-icon">âœ¨</div>
                    <div class="card-title">ÙÛ•Ø±Ù…ÙˆÙˆØ¯Û•</div>
                </a>
            </div>

            <div class="feed-header">
                <div class="feed-title">
                    <span class="live-indicator"></span>
                    <span>Ù†ÙˆÛØªØ±ÛŒÙ† Ø¨Ø§Ø¨Û•ØªÛ•Ú©Ø§Ù†</span>
                </div>
                <span style="font-size:12px; color:#888;">Ú•Ø§Ø³ØªÛ•ÙˆØ®Û†</span>
            </div>
            
            <div id="feed-container">
                <div class="loader"></div>
            </div>
            
            <div style="margin-top: 30px; text-align: center; color: #ccc; font-size: 12px;">
                Made by Muhamad Ibrahim Rasul
            </div>
        </div>

        <div class="bottom-nav">
            <a href="index.html" class="nav-item active">
                <span class="nav-icon">ğŸ </span>
                <span>Ø³Û•Ø±Û•Ú©ÛŒ</span>
            </a>
            
            <a href="quran.html" class="nav-item">
                <span class="nav-icon">ğŸ“–</span>
                <span>Ù‚ÙˆØ±Ø¦Ø§Ù†</span>
            </a>

            <a href="daily.html" class="nav-item">
                <span class="nav-icon">ğŸ•Œ</span>
                <span>Ø¨Ø§Ù†Ú¯ Ùˆ ÙÛ•Ø±Ù…ÙˆÙˆØ¯Û•</span>
            </a>
        </div>

    </div>

    <div id="settingsModal" class="modal" onclick="closeModal(event, 'settingsModal')">
        <div class="modal-content">
            <h3>âš™ï¸ Ú•ÛÚ©Ø®Ø³ØªÙ†Û•Ú©Ø§Ù†</h3>
            
            <div class="stat-row">
                <span>Ú©Û†ÛŒ Ø³Û•Ø±Ø¯Ø§Ù†Û•Ú©Ø§Ù†:</span>
                <b id="visit-count">0</b>
            </div>
            <div class="stat-row">
                <span>Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø±Ø§Ù†ÛŒ Ú†Ø§Ù„Ø§Ú©:</span>
                <b id="active-count" style="color:var(--highlight-color);">1</b>
            </div>

            <div style="text-align:right; margin-top:15px; font-weight:bold; font-size:14px; color:#777;">Ù„ÛŒØ³ØªÛŒ Ø¦Ø§Ù…ÛØ±Û•Ú©Ø§Ù†:</div>
            <div class="user-list" id="users-list-container"></div>

            <div class="settings-section-title">ğŸ“ Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒ</div>
            <div class="social-row">
                <a href="https://facebook.com/Report.Bka.Dazanm.Ter.na.buuy" target="_blank" class="social-btn"><img src="https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg"></a>
                <a href="https://www.instagram.com/hamaofficial0?igsh=MWc1bnFjbGZiMHE5MA%3D%3D&utm_source=qr" target="_blank" class="social-btn"><img src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Instagram_logo_2016.svg"></a>
                <a href="https://snapchat.com/t/b0OhYdsb" target="_blank" class="social-btn"><img src="https://upload.wikimedia.org/wikipedia/en/c/c4/Snapchat_logo.svg"></a>
                <a href="https://www.tiktok.com/@hamaofficial_0?_r=1&_t=ZS-93doDIzN8Bp" target="_blank" class="social-btn"><img src="https://upload.wikimedia.org/wikipedia/en/a/a9/TikTok_logo.svg"></a>
            </div>

            <button onclick="document.getElementById('settingsModal').style.display='none'" style="margin-top:20px; padding:8px 20px; background:var(--border-color); color:white; border:none; border-radius:5px; cursor:pointer;">Ø¯Ø§Ø®Ø³ØªÙ†</button>
        </div>
    </div>

    <div id="historyModal" class="modal" onclick="closeModal(event, 'historyModal')">
        <div class="modal-content">
            <h3>ğŸ•’ Ù…ÛÚ˜ÙˆÙˆÛŒ Ø®ÙˆÛÙ†Ø¯Ù†Û•ÙˆÛ•</h3>
            <div id="history-list-container" class="history-list"></div>
            <div style="display:flex; justify-content:space-between; align-items:center; margin-top:20px;">
                <button class="clear-btn" onclick="clearHistory()">ğŸ—‘ï¸ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ù‡Û•Ù…ÙˆÙˆÛŒ</button>
                <button onclick="document.getElementById('historyModal').style.display='none'" style="padding:8px 20px; background:var(--border-color); color:white; border:none; border-radius:5px; cursor:pointer;">Ø¯Ø§Ø®Ø³ØªÙ†</button>
            </div>
        </div>
    </div>

    <script>
        // Set Date
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('ar-IQ', options);

        // UI Functions
        function openSettings() { document.getElementById('settingsModal').style.display = 'flex'; updateStatsUI(); }
        function openHistory() { document.getElementById('historyModal').style.display = 'flex'; renderHistory(); }
        function closeModal(e, id) { if (e.target.id === id) { document.getElementById(id).style.display = 'none'; } }

        // ===========================================
        // DATA DATABASE (Massive Content)
        // ===========================================
        const db = {
            hadiths: [
                "Ø¨Ø§Ø´ØªØ±ÛŒÙ†ØªØ§Ù† Ø¦Û•ÙˆÛ•ÛŒÛ• Ú©Û• Ù‚ÙˆØ±Ø¦Ø§Ù† ÙÛØ± Ø¯Û•Ø¨ÛØª Ùˆ ÙÛØ±ÛŒ Ø®Û•ÚµÚ©ÛŒØ´ÛŒ Ø¯Û•Ú©Ø§Øª.",
                "Ù¾ÛÚ©Û•Ù†ÛŒÙ† Ø¨Û• Ú•ÙˆÙˆÛŒ Ø¨Ø±Ø§Ú©Û•ØªØ¯Ø§ Ø³Û•Ø¯Û•Ù‚Û•ÛŒÛ•.",
                "Ù¾Ø§Ú©ÙˆØ®Ø§ÙˆÛÙ†ÛŒ Ø¨Û•Ø´ÛÚ©Û• Ù„Û• Ø¦ÛŒÙ…Ø§Ù†.",
                "Ú©Û•Ø³ÛÚ©ØªØ§Ù† Ø¦ÛŒÙ…Ø§Ù†ÛŒ ØªÛ•ÙˆØ§Ùˆ Ù†ÛŒÛŒÛ• ØªØ§ Ø¦Û•ÙˆÛ•ÛŒ Ø¨Û† Ø®Û†ÛŒ Ù¾ÛÛŒ Ø®Û†Ø´Û• Ø¨Û† Ø¨Ø±Ø§Ú©Û•Ø´ÛŒ Ù¾ÛÛŒ Ø®Û†Ø´ Ù†Û•Ø¨ÛØª.",
                "Ø¯ÙˆØ¹Ø§ Ú†Û•Ú©ÛŒ Ø¨Ø§ÙˆÛ•Ú•Ø¯Ø§Ø±Û•.",
                "Ø®ÙˆØ§ Ø¬ÙˆØ§Ù†Û• Ùˆ Ø¬ÙˆØ§Ù†ÛŒ Ø®Û†Ø´Ø¯Û•ÙˆÛØª.",
                "ÙˆØªÙ†ÛŒ Ù‚Ø³Û•ÛŒ Ø¨Ø§Ø´ Ø³Û•Ø¯Û•Ù‚Û•ÛŒÛ•.",
                "Ø¨Û•Ù‡ÛØ² Ø¦Û•ÙˆÛ• Ù†ÛŒÛŒÛ• Ù„Û• Ø²Û†Ø±Ø§Ù†Ø¨Ø§Ø²ÛŒ Ø¯Û•ÛŒØ¨Ø§ØªÛ•ÙˆÛ•ØŒ Ø¨Û•Ù‡ÛØ² Ø¦Û•ÙˆÛ•ÛŒÛ• Ù„Û•Ú©Ø§ØªÛŒ ØªÙˆÙˆÚ•Û•ÛŒÛŒ Ø®Û†ÛŒ Ø¯Û•Ú¯Ø±ÛØª.",
                "Ø¦Ø§Ø±Ø§Ù…Ú¯Ø±ØªÙ† Ú•ÙˆÙˆÙ†Ø§Ú©ÛŒÛŒÛ•.",
                "Ù‡Û•Ø±Ú©Û•Ø³ÛÚ© Ú•ÛÚ¯Ø§ÛŒÛ•Ú© Ø¨Ú¯Ø±ÛØªÛ•Ø¨Û•Ø± Ø¨Û† Ø²Ø§Ù†Ø³ØªØŒ Ø®ÙˆØ§ÛŒ Ú¯Û•ÙˆØ±Û• Ú•ÛÚ¯Ø§ÛŒ Ø¨Û•Ù‡Û•Ø´ØªÛŒ Ø¨Û† Ø¦Ø§Ø³Ø§Ù† Ø¯Û•Ú©Ø§Øª.",
                "Ù…ÙˆØ³ÚµÙ…Ø§Ù† Ù„Û• Ø¯Û•Ø³Øª Ùˆ Ø²Ù…Ø§Ù†ÛŒ Ù…ÙˆØ³ÚµÙ…Ø§Ù†Ø§Ù† Ù¾Ø§Ø±ÛØ²Ø±Ø§ÙˆÛ•.",
                "Ø¦Ù‡â€ŒÙˆÙ‡â€ŒÛŒ Ø¨Ø§ÙˆÙ‡â€ŒÚ•ÛŒ Ø¨Ù‡â€Œ Ø®ÙˆØ§ Ùˆ Ú•Û†Ú˜ÛŒ Ø¯ÙˆØ§ÛŒÛŒ Ù‡Ù‡â€ŒÛŒÙ‡â€ŒØŒ Ø¨Ø§ Ù…ÛŒÙˆØ§Ù†Ù‡â€ŒÙƒÙ‡â€ŒÛŒ Ø¨Ù‡â€ŒÚ•ÛØ² Ø¨Ú¯Ø±ÛØª.",
                "Ú•Ø§Ø³ØªÚ¯Û†ÛŒÛŒ Ø¨Û•Ø±Û•Ùˆ Ú†Ø§Ú©Û• Ø¯Û•Ø¨Ø§Øª Ùˆ Ú†Ø§Ú©Û•Ø´ Ø¨Û•Ø±Û•Ùˆ Ø¨Û•Ù‡Û•Ø´Øª.",
                "Ù„Û•Ø®ÙˆØ§ØªØ±Ø³Ø§Ù† Ø³Û•Ø±ÛŒ Ù‡Û•Ù…ÙˆÙˆ Ø¯Ø§Ù†Ø§ÛŒÛŒÛ•Ú©Û•."
            ],
            duas: [
                "Ø±ÙØ¨ÙÙ‘Ù†ÙØ§ Ø¢ØªÙÙ†ÙØ§ ÙÙÙŠ Ø§Ù„Ø¯ÙÙ‘Ù†Ù’ÙŠÙØ§ Ø­ÙØ³ÙÙ†ÙØ©Ù‹ ÙˆÙÙÙÙŠ Ø§Ù„Ø¢Ø®ÙØ±ÙØ©Ù Ø­ÙØ³ÙÙ†ÙØ©Ù‹ ÙˆÙÙ‚ÙÙ†ÙØ§ Ø¹ÙØ°ÙØ§Ø¨Ù Ø§Ù„Ù†ÙÙ‘Ø§Ø±Ù",
                "Ø§Ù„Ù„Ù‡Ù… Ø¥Ù†ÙŠ Ø£Ø³Ø£Ù„Ùƒ Ø§Ù„Ù‡Ø¯Ù‰ ÙˆØ§Ù„ØªÙ‚Ù‰ ÙˆØ§Ù„Ø¹ÙØ§Ù ÙˆØ§Ù„ØºÙ†Ù‰",
                "ÙŠØ§ Ù…Ù‚Ù„Ø¨ Ø§Ù„Ù‚Ù„ÙˆØ¨ Ø«Ø¨Øª Ù‚Ù„Ø¨ÙŠ Ø¹Ù„Ù‰ Ø¯ÙŠÙ†Ùƒ",
                "Ø§Ù„Ù„Ù‡Ù… Ø¥Ù†Ùƒ Ø¹ÙÙˆ ØªØ­Ø¨ Ø§Ù„Ø¹ÙÙˆ ÙØ§Ø¹Ù Ø¹Ù†ÙŠ",
                "Ø±ÙØ¨ÙÙ‘ Ø§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙŠ ÙˆÙÙ„ÙÙˆÙØ§Ù„ÙØ¯ÙÙŠÙÙ‘",
                "Ø§Ù„Ù„Ù‡Ù… Ø¥Ù†ÙŠ Ø£Ø¹ÙˆØ° Ø¨Ùƒ Ù…Ù† Ø§Ù„Ù‡Ù… ÙˆØ§Ù„Ø­Ø²Ù†",
                "Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø£Ù†Øª Ø³Ø¨Ø­Ø§Ù†Ùƒ Ø¥Ù†ÙŠ ÙƒÙ†Øª Ù…Ù† Ø§Ù„Ø¸Ø§Ù„Ù…ÙŠÙ†"
            ],
            names: [
                { name: "Ø§Ù„Ø±Ø­Ù…Ù†", meaning: "Ø¨Û•Ø®Ø´Ù†Ø¯Û• Ø¨Û† Ù‡Û•Ù…ÙˆÙˆ Ø¯Ø±ÙˆØ³ØªÚ©Ø±Ø§ÙˆÛ•Ú©Ø§Ù†" },
                { name: "Ø§Ù„Ø±Ø­ÙŠÙ…", meaning: "Ø¨Û•Ø¨Û•Ø²Û•ÛŒÛŒ Ø¨Û† Ø¨Ú•ÙˆØ§Ø¯Ø§Ø±Ø§Ù†" },
                { name: "Ø§Ù„Ù…Ù„Ùƒ", meaning: "Ù¾Ø§Ø´Ø§ Ùˆ Ø®Ø§ÙˆÛ•Ù†ÛŒ Ù‡Û•Ù…ÙˆÙˆ Ø´ØªÛÚ©" },
                { name: "Ø§Ù„Ù‚Ø¯ÙˆØ³", meaning: "Ù¾Ø§Ú© Ùˆ Ø¨ÛÚ¯Û•Ø±Ø¯" },
                { name: "Ø§Ù„Ø³Ù„Ø§Ù…", meaning: "Ø³Û•Ø±Ú†Ø§ÙˆÛ•ÛŒ Ø¦Ø§Ø´ØªÛŒ Ùˆ Ø³Û•Ù„Ø§Ù…Û•ØªÛŒ" },
                { name: "Ø§Ù„Ù…Ø¤Ù…Ù†", meaning: "Ø¨Û•Ø®Ø´Û•Ø±ÛŒ Ø¦ÛŒÙ…Ø§Ù† Ùˆ Ø¯ÚµÙ†ÛŒØ§ÛŒÛŒ" },
                { name: "Ø§Ù„Ù…Ù‡ÙŠÙ…Ù†", meaning: "Ú†Ø§ÙˆØ¯ÛØ± Ùˆ Ø¦Ø§Ú¯Ø§Ø¯Ø§Ø±" },
                { name: "Ø§Ù„Ø¹Ø²ÙŠØ²", meaning: "Ø¨Û•Ù‡ÛØ² Ùˆ Ø´ÙƒÛ†Ø¯Ø§Ø±" },
                { name: "Ø§Ù„Ø¬Ø¨Ø§Ø±", meaning: "Ø²Û†Ø±Ø¯Ø§Ø± Ùˆ Ø¨Û•Ø¯Û•Ø³Û•ÚµØ§Øª" },
                { name: "Ø§Ù„Ù…ØªÙƒØ¨Ø±", meaning: "Ú¯Û•ÙˆØ±Û• Ùˆ Ø¨Û Ù‡Ø§ÙˆØªØ§" }
            ],
            info: [
                "ÛŒÛ•Ú©Û•Ù… Ù…Ø²Ú¯Û•ÙˆØª Ù„Û• Ø¦ÛŒØ³Ù„Ø§Ù…Ø¯Ø§ Ù…Ø²Ú¯Û•ÙˆØªÛŒ Ù‚ÙˆØ¨Ø§Ø¦Û•.",
                "ÛŒÛ•Ú©Û•Ù… Ú©Û•Ø³ Ú©Û• Ø¨Ø§ÙˆÛ•Ú•ÛŒ Ø¨Û• Ù¾ÛØºÛ•Ù…Ø¨Û•Ø± (Ø¯.Ø®) Ù‡ÛÙ†Ø§ Ø®Û•Ø¯ÛŒØ¬Û•ÛŒ Ø®ÛØ²Ø§Ù†ÛŒ Ø¨ÙˆÙˆ.",
                "Ù‚ÙˆØ±Ø¦Ø§Ù†ÛŒ Ù¾ÛŒØ±Û†Ø² Ù„Û• Ù¡Ù¡Ù¤ Ø³ÙˆØ±Û•Øª Ù¾ÛÚ©Ù‡Ø§ØªÙˆÙˆÛ•.",
                "Ø¯Ø±ÛÚ˜ØªØ±ÛŒÙ† Ø³ÙˆØ±Û•ØªÛŒ Ù‚ÙˆØ±Ø¦Ø§Ù† Ø³ÙˆØ±Û•ØªÛŒ Ø¨Û•Ù‚Û•Ø±Û•ÛŒÛ•.",
                "Ú©ÙˆØ±ØªØªØ±ÛŒÙ† Ø³ÙˆØ±Û•ØªÛŒ Ù‚ÙˆØ±Ø¦Ø§Ù† Ø³ÙˆØ±Û•ØªÛŒ Ú©Û•ÙˆØ³Û•Ø±Û•.",
                "Ù„Û• Ù…Ø§Ù†Ú¯ÛŒ Ú•Û•Ù…Û•Ø²Ø§Ù†Ø¯Ø§ Ø´Û•ÙˆÛÚ© Ù‡Û•ÛŒÛ• Ø¨Û•Ù†Ø§ÙˆÛŒ Ø´Û•ÙˆÛŒ Ù‚Û•Ø¯Ø± Ú©Û• Ù¾Ø§Ø¯Ø§Ø´ØªÛ•Ú©Û•ÛŒ Ù„Û• Ù‡Û•Ø²Ø§Ø± Ù…Ø§Ù†Ú¯ Ø¨Ø§Ø´ØªØ±Û•.",
                "Ù†ÙˆÛÚ˜ÛŒ Ø¬Û•Ù…Ø§Ø¹Û•Øª Ù¢Ù§ Ù¾Ù„Û• Ù¾Ø§Ø¯Ø§Ø´ØªÛŒ Ø²ÛŒØ§ØªØ±Û• Ù„Û• Ù†ÙˆÛÚ˜ÛŒ ØªØ§Ú©."
            ]
        };

        // ===========================================
        // DYNAMIC FEED & NOTIFICATION SYSTEM
        // ===========================================
        let notifEnabled = false;

        function enableNotifications() {
            notifEnabled = true;
            document.getElementById('notif-perm-btn').style.display = 'none';
            // Request system permission
            if ("Notification" in window) Notification.requestPermission();
            // Start the loop
            startLiveUpdates();
            alert("âœ… Ù†Û†ØªÛŒÙÛŒÚ©Û•ÛŒØ´Ù† Ú†Ø§Ù„Ø§Ú© Ú©Ø±Ø§. Ú†Ø§ÙˆÛ•Ú•ÛÛŒ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ù†ÙˆÛ Ø¨Û•...");
        }

        // Show permission button if not enabled
        setTimeout(() => {
            if(!notifEnabled) document.getElementById('notif-perm-btn').style.display = 'block';
        }, 2000);

        async function loadInitialFeed() {
            const container = document.getElementById('feed-container');
            container.innerHTML = ''; // Clear loader
            
            // Add 1 random item from each category initially
            addCardToFeed('hadith', getRandom(db.hadiths));
            await addAyahCard();
            addCardToFeed('info', getRandom(db.info));
        }

        function addCardToFeed(type, content, isNew = false) {
            const container = document.getElementById('feed-container');
            const div = document.createElement('div');
            div.className = 'feed-card';
            
            let tagHTML = '';
            let sourceHTML = '';

            if (type === 'hadith') {
                tagHTML = '<span class="feed-tag tag-hadith">ÙÛ•Ø±Ù…ÙˆÙˆØ¯Û•</span>';
                sourceHTML = 'Ù¾ÛØºÛ•Ù…Ø¨Û•Ø± (Ø¯.Ø®) Ø¯Û•ÙÛ•Ø±Ù…ÙˆÛØª';
            } else if (type === 'dua') {
                tagHTML = '<span class="feed-tag tag-dua">Ø¯ÙˆØ¹Ø§ÛŒ Ú•Û†Ú˜</span>';
                sourceHTML = 'Ø¯ÙˆØ¹Ø§ Ùˆ Ù¾Ø§Ú•Ø§Ù†Û•ÙˆÛ•';
            } else if (type === 'name') {
                tagHTML = '<span class="feed-tag tag-name">Ù†Ø§ÙˆÛŒ Ø®ÙˆØ§ÛŒ Ú¯Û•ÙˆØ±Û•</span>';
                content = `<b>${content.name}</b>: ${content.meaning}`;
                sourceHTML = 'Ø¦Û•Ø³Ù…Ø§Ø¦ÛŒ Ø­ÙˆØ³Ù†Ø§';
            } else if (type === 'info') {
                tagHTML = '<span class="feed-tag tag-info">Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ</span>';
                sourceHTML = 'Ø±Û†Ø´Ù†Ø¨ÛŒØ±ÛŒ Ø¦ÛŒØ³Ù„Ø§Ù…ÛŒ';
            } else if (type === 'ayah') {
                tagHTML = '<span class="feed-tag tag-ayah">Ø¦Ø§ÛŒÛ•ØªÛŒ Ú•Û†Ú˜</span>';
                sourceHTML = content.source; // Passed in object
                content = `"${content.text}"`;
            }

            div.innerHTML = `
                ${tagHTML}
                <div class="feed-content">${content}</div>
                <span class="feed-source">${sourceHTML} ${isNew ? 'â€¢ <span style="color:red">ØªØ§Ø²Û•</span>' : ''}</span>
            `;

            // Insert at top
            container.insertBefore(div, container.firstChild);
            
            // Limit feed size to 50 items
            if(container.children.length > 50) container.removeChild(container.lastChild);
        }

        async function addAyahCard() {
            try {
                const randomId = Math.floor(Math.random() * 6236) + 1;
                const r = await fetch(`https://api.alquran.cloud/v1/ayah/${randomId}/editions/quran-uthmani`);
                const d = await r.json();
                addCardToFeed('ayah', {
                    text: d.data[0].text,
                    source: `Ø³ÙˆØ±Ø© ${d.data[0].surah.name}`
                });
            } catch(e) { console.log("Ayah fetch error"); }
        }

        // ===========================================
        // LIVE UPDATE SIMULATOR
        // ===========================================
        function startLiveUpdates() {
            // Trigger update every 45-60 seconds
            setInterval(() => {
                triggerManualUpdate();
            }, 45000); 
        }

        function triggerManualUpdate() {
            // Pick random type
            const types = ['hadith', 'dua', 'name', 'info'];
            const type = types[Math.floor(Math.random() * types.length)];
            let content;

            if(type === 'name') content = getRandom(db.names);
            else content = getRandom(db[type + 's'] || db[type]); // Handle plurals

            addCardToFeed(type, content, true);
            playNotification();
        }

        function playNotification() {
            // 1. Play Sound
            const audio = document.getElementById('notif-sound');
            audio.currentTime = 0;
            audio.play().catch(e => console.log("Audio blocked"));

            // 2. Show System Notification
            if (Notification.permission === "granted") {
                new Notification("Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ù†ÙˆÛ Ú¯Û•ÛŒØ´Øª!", {
                    body: "Ø¨Ø§Ø¨Û•ØªÛÚ©ÛŒ Ù†ÙˆÛÛŒ Ø¦ÛŒØ³Ù„Ø§Ù…ÛŒ Ø²ÛŒØ§Ø¯Ú©Ø±Ø§ØŒ Ú©Ø±ØªÛ• Ø¨Ú©Û• Ø¨Û† Ø¨ÛŒÙ†ÛŒÙ†.",
                    icon: "https://cdn-icons-png.flaticon.com/512/2884/2884657.png"
                });
            }

            // 3. Visual Badge (Optional)
            // document.getElementById('history-badge').style.display = 'block';
        }

        function getRandom(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        // Initialize
        loadInitialFeed();


        // ===========================================
        // History Logic (Standard)
        // ===========================================
        function renderHistory() {
            const container = document.getElementById('history-list-container');
            const history = JSON.parse(localStorage.getItem('quran_history') || '[]');
            container.innerHTML = history.length ? '' : '<div style="text-align:center; color:#999; padding:20px;">Ù‡ÛŒÚ† Ù…ÛÚ˜ÙˆÙˆÛŒÛ•Ú© Ù†ÛŒÛŒÛ•</div>';
            history.forEach(item => {
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `<div class="h-info"><span class="h-name">ğŸ“– ${item.name}</span><span class="h-time">${item.date}</span></div>`;
                container.appendChild(div);
            });
        }
        function clearHistory() { if(confirm("Ø¯ÚµÙ†ÛŒØ§ÛŒØŸ")) { localStorage.removeItem('quran_history'); renderHistory(); } }

        // ===========================================
        // User Tracking
        // ===========================================
        let visits = localStorage.getItem('total_site_visits') || 0;
        visits = parseInt(visits) + 1;
        localStorage.setItem('total_site_visits', visits);
        document.getElementById('visit-count').innerText = visits;

        const myId = 'u_' + Math.random().toString(36).substr(2, 5);
        const deviceType = /Mobi|Android/i.test(navigator.userAgent) ? "ğŸ“± Ù…Û†Ø¨Ø§ÛŒÙ„" : "ğŸ’» Ú©Û†Ù…Ù¾ÛŒÙˆØªÛ•Ø±";
        let myStatus = 'online';
        const bc = new BroadcastChannel('quran_app_live_tracking');
        let activeUsers = new Map();

        function broadcastPresence() { bc.postMessage({ type: 'presence', id: myId, device: deviceType, status: myStatus, timestamp: Date.now() }); }
        bc.onmessage = (event) => { if (event.data.type === 'presence') { activeUsers.set(event.data.id, event.data); updateStatsUI(); } };
        setInterval(broadcastPresence, 2000);
        broadcastPresence();
        setInterval(() => {
            const now = Date.now();
            let changed = false;
            activeUsers.forEach((user, id) => { if (now - user.timestamp > 5000) { activeUsers.delete(id); changed = true; } });
            if(changed) updateStatsUI();
        }, 3000);
        document.addEventListener("visibilitychange", () => { myStatus = document.visibilityState === 'visible' ? 'online' : 'idle'; broadcastPresence(); });

        function updateStatsUI() {
            const list = document.getElementById('users-list-container');
            const countLabel = document.getElementById('active-count');
            list.innerHTML = '';
            list.appendChild(createUserElement(myId, deviceType, myStatus, true));
            let count = 1;
            activeUsers.forEach(user => { count++; list.appendChild(createUserElement(user.id, user.device, user.status, false)); });
            countLabel.innerText = count;
        }

        function createUserElement(id, device, status, isMe) {
            const div = document.createElement('div');
            div.className = 'user-item';
            div.innerHTML = `<span class="dot ${status==='online'?'online':'idle'}"></span><span style="flex-grow:1; margin-right:10px;">${isMe ? device+' (ØªÛ†)':device}</span><span style="color:#999;">${status==='online'?'Ú†Ø§Ù„Ø§Ú©':'Ù†Ø§Ú†Ø§Ù„Ø§Ú©'}</span>`;
            return div;
        }

        // Helper
        function openSettings() { document.getElementById('settingsModal').style.display = 'flex'; updateStatsUI(); }
        function openHistory() { document.getElementById('historyModal').style.display = 'flex'; renderHistory(); }
        function closeModal(e, id) { if (e.target.id === id) { document.getElementById(id).style.display = 'none'; } }
    </script>

</body>
</html>
