<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³Û•Ø±Û•Ú©ÛŒ - Home </title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        * { -webkit-user-select: none; user-select: none; box-sizing: border-box; }
        
        :root { --bg-color: #fffbf2; --border-color: #d4af37; --highlight-color: #27ae60; --text-color: #2c3e50; --nav-bg: #ffffff; }
        
        body { font-family: 'Amiri', serif; background-color: #f8f9fa; margin: 0; padding: 0; display: flex; justify-content: center; height: 100vh; overflow: hidden; }
        
        .app-container { width: 100%; max-width: 600px; background-color: var(--bg-color); height: 100%; position: relative; display: flex; flex-direction: column; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        
        /* Header */
        .header { background: white; padding: 15px; border-bottom: 2px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; color: var(--border-color); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .header-title { font-size: 20px; font-weight: bold; position: absolute; left: 0; right: 0; text-align: center; pointer-events: none; }
        .icon-group { display: flex; gap: 15px; z-index: 10; }
        .header-btn { cursor: pointer; font-size: 22px; padding: 5px; transition: 0.3s; }
        .header-btn:hover { transform: scale(1.1); color: #b6962f; }

        /* Main Content Area */
        .content { flex-grow: 1; overflow-y: auto; padding: 20px; padding-bottom: 80px; }

        /* Welcome Card */
        .hero-card { background: linear-gradient(135deg, var(--border-color), #f1c40f); color: white; padding: 25px; border-radius: 15px; text-align: center; margin-bottom: 25px; box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4); }
        .hero-title { font-size: 24px; margin-bottom: 10px; }
        .hero-date { font-size: 16px; opacity: 0.9; }

        /* Grid Menu */
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .card { background: white; padding: 20px; border-radius: 12px; text-align: center; border: 1px solid #eee; transition: 0.2s; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); text-decoration: none; color: var(--text-color); }
        .card:active { transform: scale(0.95); background-color: #fffbf2; }
        .card-icon { font-size: 32px; }
        .card-title { font-weight: bold; font-size: 18px; }

        /* Modals */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 200; align-items: center; justify-content: center; }
        .modal-content { background: white; width: 90%; max-width: 400px; padding: 20px; border-radius: 15px; text-align: center; border: 2px solid var(--border-color); animation: popUp 0.3s ease; position: relative; max-height: 80vh; overflow-y: auto; }
        
        /* Stats Styles */
        .stat-row { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; font-size: 14px; }
        .user-list { max-height: 120px; overflow-y: auto; margin-top: 10px; text-align: right; border: 1px solid #f0f0f0; padding: 5px; border-radius: 5px; }
        .user-item { padding: 8px; background: #f9f9f9; margin-bottom: 5px; border-radius: 5px; display: flex; align-items: center; font-size: 12px; }
        .dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-left: 8px; }
        .dot.online { background: #27ae60; box-shadow: 0 0 5px #27ae60; }
        .dot.idle { background: #f39c12; }

        /* History Styles */
        .history-list { max-height: 300px; overflow-y: auto; text-align: right; margin-top: 10px; }
        .history-item { background: #f9f9f9; padding: 10px; margin-bottom: 8px; border-radius: 8px; border-right: 3px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
        .h-info { display: flex; flex-direction: column; }
        .h-name { font-weight: bold; font-size: 16px; color: var(--text-color); }
        .h-time { font-size: 11px; color: #888; }
        .clear-btn { background: #e74c3c; color: white; border: none; padding: 5px 15px; border-radius: 15px; font-size: 12px; cursor: pointer; margin-top: 10px; }

        /* Social Media */
        .settings-section-title { margin-top: 20px; font-weight: bold; color: var(--border-color); border-bottom: 1px solid #eee; padding-bottom: 5px; margin-bottom: 15px; }
        .social-row { display: flex; justify-content: center; gap: 15px; margin-bottom: 10px; }
        .social-btn { width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: #f9f9f9; border: 1px solid #ddd; transition: 0.2s; }
        .social-btn img { width: 22px; height: 22px; }
        .social-btn:hover { transform: translateY(-3px); border-color: var(--border-color); background: #fffbf2; }

        /* Bottom Navigation Bar */
        .bottom-nav { position: absolute; bottom: 0; left: 0; width: 100%; background: var(--nav-bg); height: 70px; border-top: 1px solid #eee; display: flex; justify-content: space-around; align-items: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); z-index: 100; }
        .nav-item { text-decoration: none; display: flex; flex-direction: column; align-items: center; color: #999; font-size: 12px; gap: 5px; transition: 0.2s; width: 33.33%; }
        .nav-item.active { color: var(--border-color); font-weight: bold; }
        .nav-icon { font-size: 24px; }
        .nav-item:active { transform: scale(0.9); }

        @keyframes popUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

    </style>
</head>
<body oncontextmenu="return false;">

    <div class="app-container">
        
        <div class="header">
            <div class="icon-group">
                <div class="header-btn" onclick="openSettings()" title="Ú•ÛÚ©Ø®Ø³ØªÙ†">âš™ï¸</div>
                <div class="header-btn" onclick="openHistory()" title="Ù…ÛÚ˜ÙˆÙˆ">ğŸ•’</div>
            </div>
            <div class="header-title">Ultimate Pro</div>
            <div style="width: 60px;"></div> </div>

        <div class="content">
            <div class="hero-card">
                <div class="hero-title">Ø¨Û•Ø®ÛØ±Ø¨ÛÛŒØª</div>
                <div class="hero-date" id="current-date">Ø¬Ø§Ø±ÛŒ Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†...</div>
            </div>

            <div class="menu-grid">
                <a href="quran.html" class="card">
                    <div class="card-icon">ğŸ“–</div>
                    <div class="card-title">Ù‚ÙˆØ±Ø¦Ø§Ù†ÛŒ Ù¾ÛŒØ±Û†Ø²</div>
                </a>
                
                <a href="daily.html" class="card">
                    <div class="card-icon">ğŸ•Œ</div>
                    <div class="card-title">Ú©Ø§ØªÛ•Ú©Ø§Ù†ÛŒ Ø¨Ø§Ù†Ú¯</div>
                </a>

                <a href="daily.html" class="card">
                    <div class="card-icon">âœ¨</div>
                    <div class="card-title">ÙÛ•Ø±Ù…ÙˆÙˆØ¯Û•</div>
                </a>
            </div>

            <div style="margin-top: 30px; text-align: center; color: #ccc; font-size: 12px;">
                Made by Muhamad Ibrahim Rasul
            </div>
        </div>

        <div class="bottom-nav">
            <a href="index.html" class="nav-item active">
                <span class="nav-icon">ğŸ </span>
                <span>Ø³Û•Ø±Û•Ú©ÛŒ</span>
            </a>
            
            <a href="quran.html" class="nav-item">
                <span class="nav-icon">ğŸ“–</span>
                <span>Ù‚ÙˆØ±Ø¦Ø§Ù†</span>
            </a>

            <a href="daily.html" class="nav-item">
                <span class="nav-icon">ğŸ•Œ</span>
                <span>Ø¨Ø§Ù†Ú¯ Ùˆ ÙÛ•Ø±Ù…ÙˆÙˆØ¯Û•</span>
            </a>
        </div>

    </div>

    <div id="settingsModal" class="modal" onclick="closeModal(event, 'settingsModal')">
        <div class="modal-content">
            <h3>âš™ï¸ Ú•ÛÚ©Ø®Ø³ØªÙ†Û•Ú©Ø§Ù†</h3>
            
            <div class="stat-row">
                <span>Ú©Û†ÛŒ Ø³Û•Ø±Ø¯Ø§Ù†Û•Ú©Ø§Ù†:</span>
                <b id="visit-count">0</b>
            </div>
            <div class="stat-row">
                <span>Ø¨Û•Ú©Ø§Ø±Ù‡ÛÙ†Û•Ø±Ø§Ù†ÛŒ Ú†Ø§Ù„Ø§Ú©:</span>
                <b id="active-count" style="color:var(--highlight-color);">1</b>
            </div>

            <div style="text-align:right; margin-top:15px; font-weight:bold; font-size:14px; color:#777;">Ù„ÛŒØ³ØªÛŒ Ø¦Ø§Ù…ÛØ±Û•Ú©Ø§Ù†:</div>
            <div class="user-list" id="users-list-container"></div>

            <div class="settings-section-title">ğŸ“ Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒ</div>
            <div class="social-row">
                <a href="https://facebook.com/Report.Bka.Dazanm.Ter.na.buuy" target="_blank" class="social-btn"><img src="https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg"></a>
                <a href="https://www.instagram.com/hamaofficial0?igsh=MWc1bnFjbGZiMHE5MA%3D%3D&utm_source=qr" target="_blank" class="social-btn"><img src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Instagram_logo_2016.svg"></a>
                <a href="https://snapchat.com/t/b0OhYdsb" target="_blank" class="social-btn"><img src="https://upload.wikimedia.org/wikipedia/en/c/c4/Snapchat_logo.svg"></a>
                <a href="https://www.tiktok.com/@hamaofficial_0?_r=1&_t=ZS-93doDIzN8Bp" target="_blank" class="social-btn"><img src="https://upload.wikimedia.org/wikipedia/en/a/a9/TikTok_logo.svg"></a>
            </div>

            <button onclick="document.getElementById('settingsModal').style.display='none'" style="margin-top:20px; padding:8px 20px; background:var(--border-color); color:white; border:none; border-radius:5px; cursor:pointer;">Ø¯Ø§Ø®Ø³ØªÙ†</button>
        </div>
    </div>

    <div id="historyModal" class="modal" onclick="closeModal(event, 'historyModal')">
        <div class="modal-content">
            <h3>ğŸ•’ Ù…ÛÚ˜ÙˆÙˆÛŒ Ø®ÙˆÛÙ†Ø¯Ù†Û•ÙˆÛ•</h3>
            
            <div id="history-list-container" class="history-list">
                </div>

            <div style="display:flex; justify-content:space-between; align-items:center; margin-top:20px;">
                <button class="clear-btn" onclick="clearHistory()">ğŸ—‘ï¸ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ù‡Û•Ù…ÙˆÙˆÛŒ</button>
                <button onclick="document.getElementById('historyModal').style.display='none'" style="padding:8px 20px; background:var(--border-color); color:white; border:none; border-radius:5px; cursor:pointer;">Ø¯Ø§Ø®Ø³ØªÙ†</button>
            </div>
        </div>
    </div>

    <script>
        // Set Date
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('ar-IQ', options);

        // UI Functions
        function openSettings() { 
            document.getElementById('settingsModal').style.display = 'flex'; 
            updateStatsUI(); 
        }

        function openHistory() {
            document.getElementById('historyModal').style.display = 'flex';
            renderHistory();
        }

        function closeModal(e, id) {
            if (e.target.id === id) { document.getElementById(id).style.display = 'none'; }
        }

        // ===========================================
        // History Logic
        // ===========================================
        function renderHistory() {
            const container = document.getElementById('history-list-container');
            const history = JSON.parse(localStorage.getItem('quran_history') || '[]');
            
            container.innerHTML = '';
            
            if(history.length === 0) {
                container.innerHTML = '<div style="text-align:center; color:#999; padding:20px;">Ù‡ÛŒÚ† Ù…ÛÚ˜ÙˆÙˆÛŒÛ•Ú© ØªÛ†Ù…Ø§Ø± Ù†Û•Ú©Ø±Ø§ÙˆÛ•</div>';
                return;
            }

            history.forEach(item => {
                // If item.date is stored as simple date string, we might not have exact time unless we update storage. 
                // Assuming standard format stored from quran.html
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `
                    <div class="h-info">
                        <span class="h-name">ğŸ“– ${item.name}</span>
                        <span class="h-time">${item.date}</span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function clearHistory() {
            if(confirm("Ø¯ÚµÙ†ÛŒØ§ÛŒ Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ù‡Û•Ù…ÙˆÙˆ Ù…ÛÚ˜ÙˆÙˆÛ•Ú©Û•ØŸ")) {
                localStorage.removeItem('quran_history');
                renderHistory();
            }
        }

        // ===========================================
        // Live User Tracking System
        // ===========================================
        let visits = localStorage.getItem('total_site_visits') || 0;
        visits = parseInt(visits) + 1;
        localStorage.setItem('total_site_visits', visits);
        document.getElementById('visit-count').innerText = visits;

        const myId = 'u_' + Math.random().toString(36).substr(2, 5);
        const deviceType = /Mobi|Android/i.test(navigator.userAgent) ? "ğŸ“± Ù…Û†Ø¨Ø§ÛŒÙ„" : "ğŸ’» Ú©Û†Ù…Ù¾ÛŒÙˆØªÛ•Ø±";
        let myStatus = 'online';

        const bc = new BroadcastChannel('quran_app_live_tracking');
        let activeUsers = new Map();

        function broadcastPresence() {
            bc.postMessage({
                type: 'presence',
                id: myId,
                device: deviceType,
                status: myStatus,
                timestamp: Date.now()
            });
        }

        bc.onmessage = (event) => {
            if (event.data.type === 'presence') {
                activeUsers.set(event.data.id, event.data);
                updateStatsUI();
            }
        };

        setInterval(broadcastPresence, 2000);
        broadcastPresence();

        setInterval(() => {
            const now = Date.now();
            let changed = false;
            activeUsers.forEach((user, id) => {
                if (now - user.timestamp > 5000) {
                    activeUsers.delete(id);
                    changed = true;
                }
            });
            if(changed) updateStatsUI();
        }, 3000);

        document.addEventListener("visibilitychange", () => {
            myStatus = document.visibilityState === 'visible' ? 'online' : 'idle';
            broadcastPresence();
        });

        function updateStatsUI() {
            const listContainer = document.getElementById('users-list-container');
            const countLabel = document.getElementById('active-count');
            
            listContainer.innerHTML = '';
            
            listContainer.appendChild(createUserElement(myId, deviceType, myStatus, true));

            let count = 1;
            activeUsers.forEach(user => {
                count++;
                listContainer.appendChild(createUserElement(user.id, user.device, user.status, false));
            });

            countLabel.innerText = count;
        }

        function createUserElement(id, device, status, isMe) {
            const div = document.createElement('div');
            div.className = 'user-item';
            const statusClass = status === 'online' ? 'online' : 'idle';
            const statusText = status === 'online' ? 'Ú†Ø§Ù„Ø§Ú©' : 'Ù†Ø§Ú†Ø§Ù„Ø§Ú©';
            const label = isMe ? `${device} (ØªÛ†)` : device;
            
            div.innerHTML = `
                <span class="dot ${statusClass}"></span>
                <span style="flex-grow:1; margin-right:10px;">${label}</span>
                <span style="color:#999;">${statusText}</span>
            `;
            return div;
        }

    </script>

</body>
</html>
